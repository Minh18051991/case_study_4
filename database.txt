create database case_study_4;
use case_study_4;
-- thêm bảng role
create table role
(
    id        int primary key auto_increment,
    name      varchar(50),
    is_delete boolean default false
);
-- thêm bảng account
create table account
(
    id        int primary key auto_increment,
    username  varchar(100) unique not null,
    password  text        not null,
    is_delete boolean default false
);

-- them bang account_role
create table account_role
(
    id         int primary key auto_increment,
    account_id int,
    role_id    int,
    unique (account_id, role_id),
    foreign key (account_id) references account (id),
    foreign key (role_id) references role (id)
);
-- thêm bảng position
create table employee_position
(
    id        int primary key auto_increment,
    name      varchar(100) not null,
    is_delete boolean default false
);
-- thêm bảng employee
create table employee
(
    id          int primary key auto_increment,
    name        varchar(100)        not null,
    email       varchar(100) unique not null,
    gender      boolean,
    address     varchar(255),
    phone       varchar(20),
    birth_date date,
    image_url text,
    salary     decimal(10, 2),
    is_delete   boolean default false,
    position_id int,
    foreign key (position_id) references employee_position (id),
    account_id  int,
    foreign key (account_id) references account (id)
);
-- thêm bảng course
create table course
(
    id        int primary key auto_increment,
    name      varchar(100) not null,
    duration  varchar(50),-- thời gian học 1 khóa
    is_delete boolean default false
);
-- thêm bảng module
create table module
(
    id        int primary key auto_increment,
    name      varchar(100) not null,
    is_delete boolean default false,
    course_id int,
    foreign key (course_id) references course (id)
);
-- thêm bảng lesson
create table lesson
(
    id        int primary key auto_increment,
    name      varchar(100) not null,
    is_delete boolean default false,
    module_id int,
    foreign key (module_id) references module (id)
);
-- thêm bảng category_activity
create table category_activity
(
    id        int primary key auto_increment,
    name      varchar(100) not null,
    is_delete boolean default false
);
-- thêm bảng activity
create table activity
(
    id                   int primary key auto_increment,
    name                 varchar(100) not null,
    is_delete            boolean default false,
    category_activity_id int,
    foreign key (category_activity_id) references category_activity (id),
    lesson_id            int,
    foreign key (lesson_id) references lesson (id)
);
-- thêm bảng class
create table class
(
    id          int primary key auto_increment,
    name        varchar(100),
    start_date  datetime default current_timestamp,
    is_delete   boolean  default false,
    employee_id int,
    foreign key (employee_id) references employee (id),
    course_id   int,
    foreign key (course_id) references course (id)
);
-- thêm bảng student
create table student
(
    id         int primary key auto_increment,
    name       varchar(100)        not null,
    email      varchar(100) unique not null,
    gender     boolean,
    address    varchar(255),
    phone      varchar(20),
    birth_date date,
    image_url text,
    is_delete  boolean default false,
    class_id   int,
    foreign key (class_id) references class (id),
    account_id int,
    foreign key (account_id) references account (id)
);
-- thêm bảng điểm danh(attendance)
create table attendance
(
    id          int primary key auto_increment,
    create_at   datetime default current_timestamp,
    status      enum ('vắng có phép','có mặt','đi muộn','vắng không phép'),
    note        text,
    is_delete   boolean  default false,
    student_id  int,
    foreign key (student_id) references student (id),
    class_id    int,
    foreign key (class_id) references class (id),
    employee_id int,
    foreign key (employee_id) references employee (id)
);
-- thêm bảng nhật ký(diary)
create table dailynote
(
    id          int primary key auto_increment,
    create_at   datetime default current_timestamp,
    content     text,
    is_delete   boolean  default false,
    employee_id int,
    foreign key (employee_id) references employee (id),
    class_id    int,
    foreign key (class_id) references class (id)
);
-- thêm bảng tiến trình học tập(progress)
create table progress
(
    id          int primary key auto_increment,
    status      boolean default false,
    is_delete   boolean default false,
    student_id  int,
    foreign key (student_id) references student (id),
    activity_id int,
    foreign key (activity_id) references activity (id)
);
-- thêm bảng điểm số (score)
create table score
(
    id         int primary key auto_increment,
    theory     double,
    practice   double,
    is_delete  boolean default false,
    student_id int,
    foreign key (student_id) references student (id),
    module_id  int,
    foreign key (module_id) references module (id)
);